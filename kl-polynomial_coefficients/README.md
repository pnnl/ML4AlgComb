# The coefficients of Kazhdan-Lusztig polynomials (open problem)

Kazhdan-Lusztig (KL) polynomials are integer polynomials in a variable $q$ that (for our purposes) are indexed by a pair of permutations \[1\]. We will write the KL polynomial associated with permutations $\sigma$ and $\nu$ as $P_{\sigma,\nu}(q)$. For example, the KL polynomial associated with permutations $\sigma = 1$ $4$ $3$ $2$ $7$ $6$ $5$ $10$ $9$ $8$ $11$ and $\nu = 4$ $6$ $7$ $8$ $9$ $10$ $1$ $11$ $2$ $3$ $5$ is

$P_{\sigma,\nu} = 1 + 16q + 103q^2 + 337q^3 + 566q^4 + 529q^5 + 275q^6 + 66q^7 + 3q^8.$

KL polynomials have deep connections throughout several areas of mathematics. For example, KL polynomials are related to the dimensions of intersection homology in Schubert calculus, the study of the Hecke algebra, and representation theory of the symmetric group. They can be computed via a recursive formula \[1\], nevertheless, in many ways they remain mysterious. For instance, there is no known closed formula for the degree of $P_{\sigma,\nu}(q)$.

One type of question of special interest is the value of coefficient on the terms of $q$ in $P_{\sigma,\nu}(q)$. Perhaps most well-known is the question of the coefficient on term $q^{\ell(\sigma) - \ell(\nu)-1/2}$ (where $\ell(x)$ is a statistic called the length of the permutation), which is known as the $\mu$-coefficient. Better understanding of this and other coefficients has the potential to shed considerable light on other aspects of this family of polynomials. 

**Dataset:** Each instance in this dataset consists of a pair of permutations on $n$, $\sigma$ and $\nu$, along with the coefficients of $P_{\sigma,\nu}(q)$. We provide $n = 8,9$.

**Task:** The task to predict the coefficients of $P_{\sigma,\nu}(q)$ given $\sigma$ and $\nu$ (below, we only show results for predicting the coefficient on $q^2$).

We link to datasets generated by Greg Warrington and associated with \[2\]. The dataset for $n = 8$ can be found [here](https://gswarrin.w3.uvm.edu/research/klc/eps-s8-klps) and the dataset for $n = 9$ can be found [here](https://gswarrin.w3.uvm.edu/research/klc/eps-s9-klps). We provide code to do formatting and make official train/test splits in the this repo.

## Data itself

If $v =$ $0$ $2$ $1$ $3$ $5$ $4$ $6$ $9$ $7$ $8$ and $w=2$ $3$ $0$ $5$ $9$ $6$ $7$ $8$ $1$ $4$ then $P_{v,w}(q) = 4q^4+12q^3+13q^2+6q+1$ and this is written as the line

``0213546978 2305967814 1,6,13,12,4.``

The files we provide are: 
- ``processed_S5_train.txt``
- ``processed_S6_test.txt``

## Prediction of the coefficient on $q^2$

### Logistic Regression

| Dataset Size | Test Accuracy | 
|----------|----------|
| $n= 8$ | $78.2$% |
| $n= 9$  | $57.0$% |

### MLP

| Dataset Size | Learning Rate | Hidden Dimension | Depth | Test Accuracy | 
|----------|----------|----------|----------|----------|
| $n= 8$ | 0.001 | 256 | 4 | $87.2$% | 
| $n= 9$  | 0.001 | 256 | 4 | $80.1$% |

### Transformer

| Dataset Size | Learning Rate | Hidden Dimension | Depth | Heads | Test Accuracy | 
|----------|----------|----------|----------|----------|----------|
| $n= 8$ | 0.0005 | 80 | 6 | 8 | $89.0$% |
| $n= 9$  | 0.0001 | 80 | 6 | 4 | $96.9$% |

\[1\] Kazhdan, David, and George Lusztig. "Representations of Coxeter groups and Hecke algebras." Inventiones mathematicae 53.2 (1979): 165-184.

\[2\] Warrington, Gregory S. "Equivalence classes for the μ-coefficient of Kazhdan–Lusztig polynomials in Sn." Experimental Mathematics 20.4 (2011): 457-466.
